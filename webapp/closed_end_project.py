firm_names = {'Bank of America Corp': 'BofA', 'New York Life Insurance Co': 'NYL', 'Van Eck Associates Corp': 'Van Eck', 'Morgan Stanley': 'MS', 'Fort Point Capital Partners LLC': 'Fort Point', 'Royal Bank of Canada': 'RBC', 'Blue Bell Private Wealth Managemen': 'Blue Bell', 'A Montag & Associates Inc': 'Montag', 'Able Wealth Management LLC': 'Able Wealth', 'Adviser Investments LLC': 'Adviser Investments', 'Advisor Os LLC': 'Advisor Os', 'Advisor Partners II LLC': 'Advisor Partners II', 'Advisor Resource Council LLC': 'Advisor Resource Council', 'Advisory Services Network LLC': 'Advisory Services Network', 'Allen Mooney & Barnes Investment A': 'Allen Mooney', 'Alpha Cubed Investments LLC': 'Alpha Cubed', 'American Institute For Advanced In': 'American Institute', 'Ameritas Advisory Services LLC': 'Ameritas Advisory', 'Ameritas Investment Partners Inc': 'Ameritas Investment', 'Hennion & Walsh Asset Management I': 'Hennion', 'Saba Capital Management LP': 'Saba', 'Logan Stone Capital LLC': 'Logan Stone', 'RiverNorth Capital Management LLC': 'RiverNorth', 'Deschutes Portfolio Strategy LLC': 'Deschutes', 'Guggenheim Partners LLC': 'Guggenheim', 'AQR Arbitrage LLC': 'AQR', 'Coastal Investment Advisors Inc': 'Coastal', 'Wells Fargo & Co': 'Wells', 'Almitas Capital LLC': 'Almitas', 'Wolverine Asset Management LLC': 'Wolverine', 'Allspring Global Investments Holdi': 'Allspring', 'Thomas J Herzfeld Advisors Inc': 'Thomas', 'Wealth Enhancement Group LLC': 'Wealth Enhancement', 'Liberty Street Advisors Inc': 'Liberty Street', 'Robinson Capital Management LLC': 'Robinson', 'Capital Investment Advisors LLC/GA': 'Capital Investment', 'HARA CAPITAL LLC': 'HARA', 'Berger Financial Group Inc': 'Berger', 'Sightline Wealth Advisors LLC': 'Sightline', 'Element Wealth LLC': 'Element', 'Landscape Capital Management LLC': 'Landscape', 'AQR Capital Management LLC': 'AQR Capital', 'Melfa Wealth Management Inc': 'Melfa', 'UBS AG': 'UBS', 'Genstar Capital LLC': 'Genstar', 'Kingswood Wealth Advisors LLC': 'Kingswood', 'Osaic Holdings Inc': 'Osaic', 'Pathstone Holdings LLC': 'Pathstone', 'Nomura Holdings Inc': 'Nomura', 'LPL Financial LLC': 'LPL', 'Wedbush Securities Inc': 'Wedbush', 'Commonwealth Equity Services LLC': 'Commonwealth', 'Oneascent Financial Services LLC': 'Oneascent', 'Ameriprise Financial Inc': 'Ameriprise Financial', 'Koshinski Asset Management Inc': 'Koshinski', 'Highmark Wealth Management LLC': 'Highmark', 'Moneta Group Investment Advisors L': 'Moneta', 'CWM LLC': 'CWM', 'Principal Financial Group Inc': 'Principal', 'Comerica Bank': 'Comerica', 'PNC Financial Services Group Inc/T': 'PNC', 'Tucker Asset Management LLC': 'Tucker', 'Reit Todd': 'Reit Todd', 'Maher Bill': 'Maher', 'GPS Wealth Strategies Group LLC': 'GPS Wealth', 'Baystate Wealth Management LLC': 'Baystate', 'Global Retirement Partners LLC': 'Global Retirement', 'Avior Wealth Management LLC': 'Avior', 'Bessemer Group Inc/The': 'Bessemer', 'Tower Research Capital LLC': 'Tower Research', 'SIG Holding LLC': 'SIG', 'JPMorgan Chase & Co': 'JPMorgan', 'Walter & Keenan Financial Consulti': 'Walter & Keenam', 'HighTower Advisors LLC': 'HighTower', 'Walker Asset Management LLC': 'Walker', 'Krilogy Financial LLC': 'Krilogy', 'Smith Moore & Co': 'Smith Moore', 'Buckingham Strategic Wealth LLC': 'Buckingham', 'Central Trust Co': 'Central Trust', 'Franklin Resources Inc': 'Franklin', 'US Bancorp': 'US Bancorp', 'Detalus Advisors LLC': 'Detalus', 'Deutsche Bank AG': 'Deutsche', 'Stablepoint Partners LLC': 'Stablepoint', 'Napa Wealth Management Inc': 'Napa', 'Raymond James Financial Inc': 'Raymond James', 'Integrated Wealth Concepts LLC': 'Integrated', 'Sit Investment Associates Inc': 'Sit', 'PFG Investments LLC': 'PFG', 'Eagle Bay Advisors LLC': 'Eagle Bay', 'Herold Advisors Inc': 'Herold', 'Twin Focus Capital Partners LLC': 'Twin Focus', 'Citadel Advisors LLC': 'Citadel', 'Tortoise Investment Management LLC': 'Tortoise', 'St Germain Investment Management I': 'St Germain', 'Northwestern Mutual Wealth Managem': 'Northwestern Mutual', 'Benjamin F Edwards & Co Inc': 'Benjamin', 'FNY Investment Advisers LLC': 'FNY', 'Fifth Third Bancorp': 'Fifth Third', 'Karpus Management Inc': 'Karpus', 'Bramshill Investments LLC': 'Bramshill', 'Touchstone Advisors Inc': 'Touchstone', 'Penderfund Capital Management Ltd': 'Penderfund', 'Gill Capital Partners LLC': 'Gill', 'Fiera Capital Corp': 'Fiera', 'Eagle Bluffs Wealth Management LLC': 'Eagle Bluffs', 'Sun Life Financial Inc': 'Sun Life', 'Exchange Traded Concepts LLC': 'Exchange Traded Concepts', 'ETF Managers Group LLC': 'ETF Managers', 'Stifel Financial Corp': 'Stifel', 'Penserra Capital Management LLC': 'Penserra', 'Rockefeller Capital Management LP': 'Rockefeller', 'Dakota Wealth Management LLC': 'Dakota', 'City of London Investment Group PL': 'City of London', 'Envestnet Asset Management Inc': 'Envestnet', 'Tyche Wealth Partner LLC': 'Tyche', 'Baird Financial Group Inc/Wisconsi': 'Baird', 'Nine Masts Capital Ltd': 'Nine Masts', 'GFS Advisors LLC': 'GFS', 'STRATEGIC INVESTMENTS GROUP LTD': 'Strategic Investments', 'LM Advisors LLC': 'LM', 'Hirtle Callaghan & Co LLC': 'Hirtle Callaghan', 'TACTICAL FUND ADVISORS LLC': 'Tactical Fund', 'Allianz SE': 'Allianz', 'Freestone Capital Holdings LLC': 'Freestone', 'Park Avenue Securities LLC': 'Park Ave', 'Cohen & Steers Inc': 'Cohen & Steers', 'Indiana Trust and Investment Manag': 'Indiana Trust', 'Congress Park Capital LLC': 'Congress Park', 'Cornerstone Advisory LLP': 'Cornerstone', 'Clearwater Management Co Inc': 'Clearwater', 'US Capital Wealth Advisors LLC': 'US Capital Wealth', 'Cambridge Investment Research Advi': 'Cambridge', 'Mesirow Financial Holdings Inc': 'Mesirow', 'Savant Capital Management Inc': 'Savant', 'Kestra Advisory Services LLC': 'Kestra', '1776 Wealth LLC': '1776', 'Mutual Advisors LLC': 'Mutual Advisors', 'Invesco Ltd': 'Invesco', 'Wakefield Asset Management LLLP': 'Wakefield', 'Onedigital Investment Advisors LLC': 'Onedigital', 'Leo Wealth LLC': 'Leo', 'Palogic Value Management LP': 'Palogic', 'Arete Wealth Advisors LLC': 'Arete', 'Centiva Capital LP': 'Centiva', 'XML Financial LLC': 'XML', 'Janney Montgomery Scott LLC': 'Janney Montgomery', 'Riverbridge Partners LLC': 'Riverbridge', 'Archetype Wealth Partners LLC': 'Archetype', 'Wealth Advisors of Tampa Bay LLC': 'Tampa Bay', 'Horizon Kinetics LLC': 'Horizon', 'Private Advisor Group LLC/NJ': 'Private Advisor Group', 'Prospera Financial Services Inc': 'Prospera', 'Mariner LLC': 'Mariner', 'Melone Private Wealth LLC': 'Melone', 'McGowan Group Asset Management Inc': 'McGowan', 'Catalytic Wealth RIA LLC': 'Catalytic', 'Geowealth Management LLC': 'Geowealth', 'Stratos Wealth Partners Ltd': 'Stratos', 'CliftonLarsonAllen Wealth Advisors': 'CliftonLarsonAllen', 'IFP Advisors Inc': 'IFP', 'Bank of New York Mellon Corp/The': 'BNY Mellon', 'Newedge Advisors Llc': 'Newedge', 'Oppenheimer & Co Inc': 'Oppenheimer', 'Crescent Grove Advisors LLC': 'Crescent Grove', 'Steward Partners Investment Adviso': 'Steward Partners', 'BNC Wealth Management LLC': 'BNC', 'Claro Advisors LLC': 'Claro', 'Journey Strategic Wealth LLC': 'Journey Strategic', 'Corient Private Wealth LLC': 'Corient', 'Parsons Capital Management Inc': 'Parsons', 'Bank of Montreal': 'BMO', 'RFG Advisory Group LLC': 'RFG', 'Barry Investment Advisors LLC': 'Barry', 'Wellspring Financial Advisors LLC': 'Wellspring', 'Concurrent Investment Advisors LLC': 'Concurrent', 'Truist Financial Corp': 'Truist', 'Relative Value Partners Group LLC': 'Relative Value', 'Choreo LLC': 'Choreo', 'Brown Advisory Inc': 'Brown', 'Sterneck Capital Management LLC': 'Sterneck', 'Gould Capital LLC': 'Gould', 'Spire Wealth Management LLC': 'Spire', 'Integrated Capital Management Inc': 'Integrated Capital', 'Walleye Capital LLC': 'Walleye', 'DA Davidson Cos': 'DA Davidson', 'Silverlake Wealth Management LLC': 'Silverlake', 'CFM Wealth Partners LLC': 'CFM', 'Ellis Investment Partners LLC': 'Ellis', 'Fortitude Advisory Group LLC': 'Fortitude', 'Ackerman Capital Advisors LLC': 'Ackerman', 'Widmann Financial Services Inc': 'Widmann', 'Peddock Capital Advisors LLC': 'Peddock', 'Wealth Alliance Advisory Group LLC': 'Wealth Alliance', 'Meixler Investment Management Ltd': 'Meixler', 'Cresset Partners LLC': 'Cresset', 'Kuhn & Co Investment Counsel': 'Kuhn & Co', 'Hollencrest Capital Management LLC': 'Hollencrest', 'B Riley Wealth Advisors Inc': 'B Riley', 'Drive Wealth Management LLC': 'Drive', 'Carmichael Hill & Associates Inc': 'Carmichael Hill', 'Simon Quick Advisors LLC': 'Simon Quick', 'Compass Financial Group Inc': 'Compass', 'BBR Partners LLC': 'BBR Partners', 'Magnus Financial Group LLC': 'Magnus', 'Choate Investment Advisors LLC': 'Choate', 'Luther King Capital Management Cor': 'Luther King', 'MML Investors Services LLC': 'MML', 'Integrated Advisors Network LLC': 'Integrated Advisors', 'Grace Partners of DuPage LP': 'Grace Partners', 'Bayshore Asset Management LLC': 'Bayshore', 'Snowden Capital Advisors LLC': 'Snowden', 'Bank of Nova Scotia/The': 'Scotiabank', 'Catalina Capital Group LLC': 'Catalina', 'Corecap Advisors LLC': 'Corecap', 'AE Wealth Management LLC': 'AE', 'Summit Financial LLC': 'Summit', 'Diligent Investors LLC': 'Diligent', 'Quad-Cities Investment Group LLC': 'Quad-Cities', 'Capital Advisors Inc/OK': 'Capital Advisors', 'Virtu Financial LLC': 'Virtu', 'Sunbelt Securities Inc': 'Sunbelt', 'Lincoln National Corp': 'Lincoln National', 'Captrust Financial Advisors LLC': 'Captrust', 'Archford Capital Strategies LLC': 'Archford', 'Vivaldi Capital Management LP': 'Vivaldi', 'Chicago Partners Investment Group': 'Chicago Partners', 'Summit Trail Advisors LLC': 'Summit Trail', 'Young Robert Lynn': 'Young Robert Lynn', 'Ironsides Asset Advisors LLC': 'Ironsides', 'Kercheville Advisors LLC': 'Kercheville', 'Family Management Corp': 'Family Management Corp', 'Bridgecreek Investment Management': 'Bridgecreek', 'Carlton Hofferkamp & Jenks Wealth': 'Carlton Hofferkamp & Jenks', 'TCG Advisory Services LLC': 'TCG', 'Kennicott Capital Management LLC': 'Kennicott', 'Curi RMB Capital LLC': 'Curi RMB', 'IHT Wealth Management LLC': 'IHT', 'Alesco Advisors LLC': 'Alesco', 'Merit Financial Group LLC': 'Merit', 'Carson Advisory Inc': 'Carson', 'Institute for Wealth Management LL': 'Institute', 'SFMG LLC': 'SFMG', 'Old National Bancorp/IN': 'Old', 'Pacitti Group Inc': 'Pacitti', 'Sheaff Brock Investment Advisors L': 'Sheaff', 'Lido Advisors LLC': 'Lido', 'Kingsview Wealth Management LLC': 'Kingsview', 'Neuberger Berman Group LLC': 'Neuberger', 'Bar Harbor Wealth Management': 'Bar', 'Beacon Investment Advisors LLC': 'Beacon', 'Moody National Bank': 'Moody', 'Aptus Capital Advisors LLC': 'Aptus', 'Wintrust Investments LLC': 'Wintrust', 'Keystone Wealth Services LLC': 'Keystone', 'Whittier Trust Co of Nevada Inc': 'Whittier', 'Cyndeo Wealth Partners LLC': 'Cyndeo', 'SMH Capital Advisors LLC': 'SMH', 'Stonebrook Private Inc': 'Stonebrook', 'Second Line Capital LLC': 'Second', 'Strategiq Financial Group LLC': 'Strategiq', 'Occidental Asset Management LLC': 'Occidental', 'Tiaa Trust NA': 'Tiaa', 'Warren Averett Asset Management LL': 'Warren', 'Moors & Cabot Inc': 'Moors', 'Fruth Investment Management Inc': 'Fruth', 'Evanson Asset Management LLC': 'Evanson', 'Visionpoint Advisory Group Inc': 'Visionpoint', 'Vestor Capital LLC': 'Vestor', 'Sandy Spring Bank': 'Sandy', 'Ancora Advisors LLC': 'Ancora', 'North Star Investment Management C': 'North', 'Delta Asset Management LLC/TN': 'Delta', 'TCTC Holdings LLC': 'TCTC', 'Private Trust Co NA/The': 'Private', 'Concourse Financial Group Securiti': 'Concourse', 'Toth Terence J': 'Toth', 'Truist Bank': 'Truist', 'Tradewinds Capital Management LLC': 'Tradewinds', 'Founders Capital Management Inc': 'Founders', 'Cullen/Frost Bankers Inc': 'Cullen/Frost', 'JFS Wealth Advisors LLC': 'JFS', 'Palisade Asset Management LLC': 'Palisade', 'First Horizon Advisors Inc': 'First', 'Parallel Advisors LLC': 'Parallel', 'Highlander Capital Management LLC': 'Highlander', 'FSA Wealth Management LLC': 'FSA', 'UMB Bank NA/Kansas City MO': 'UMB', 'CNB Bank': 'CNB', 'Bedford Grange Mutual Ins Co': 'Bedford', 'Allworth Financial LP': 'Allworth', 'ICA Group Wealth Management LLC': 'ICA', 'City State Bank/Norwalk IA': 'City', 'Harbour Investments Inc': 'Harbour', 'Sachetta LLC': 'Sachetta', 'Webster Bank NA': 'Webster', 'ORG Partners LLC': 'ORG', 'BOKF NA': 'BOKF', 'Lowe Wealth Advisors LLC': 'Lowe', 'Hartford Financial Services Group': 'Hartford', 'TFC Financial Management Inc': 'TFC', 'Jones Nathaniel T': 'Jones', 'Zimmerman Gifford Ross': 'Zimmerman', 'Financial Management Professionals': 'Financial', 'Atlantic Edge Private Wealth Manag': 'Atlantic', 'Northwest Financial Advisors LLC': 'Northwest', 'Canadian Imperial Bank of Commerce': 'Canadian', 'First United Bank & Trust': 'First', 'Adirondack Trust Co/Saratoga Sprin': 'Adirondack', 'Harbor Investment Advisory LLC': 'Harbor', 'Concord Wealth Partners LLC': 'Concord', 'Siffermann William A': 'Siffermann', 'Mascoma Wealth Management LLC': 'Mascoma', 'Seasons of Advice Wealth Managemen': 'Seasons', 'Duncker Streett & Co Inc': 'Duncker', 'Bedel Financial Consulting Inc': 'Bedel', 'FMR LLC': 'FMR', 'Western Wealth Management LLC': 'Western', 'Capital Investment Advisory Servic': 'Capital', 'Northern Trust Corp': 'Northern', 'Salomon & Ludwin LLC': 'Salomon', 'Sollinda Capital Management LLC': 'Sollinda', 'Crestone Asset Management LLC': 'Crestone', 'Advisornet Financial Inc': 'Advisornet', 'Livelsberger Financial Advisory In': 'Livelsberger', 'Whittier Trust Co': 'Whittier', 'Operose Advisors LLC': 'Operose', 'Creative Planning LLC': 'Creative', 'Cary Street Partners Investment Ad': 'Cary', 'Bryn Mawr Trust Co/The': 'Bryn', 'Transform Wealth LLC': 'Transform', 'Weiss Asset Management LP': 'Weiss', 'Portfolio Strategies Inc/NY': 'Portfolio', 'Shufro Rose & Co LLC': 'Shufro', 'Bartlett & Co Wealth Management LL': 'Bartlett', 'Mission Wealth Management LLC': 'Mission', 'Balboa Wealth Partners Inc': 'Balboa', 'Staley Capital Advisers Inc': 'Staley', 'ProVise Management Group LLC': 'ProVise', 'Samalin Investment Counsel LLC': 'Samalin', 'Pine Valley Investments LLC': 'Pine', 'Ashton Thomas Private Wealth LLC': 'Ashton', 'Arlington Capital Management Inc': 'Arlington', 'Vista Investment Partners LLC': 'Vista', 'FLC Capital Advisors': 'FLC', 'Ausdal Financial Partners Inc': 'Ausdal', 'Farther Finance Advisors LLC': 'Farther', 'Cardona John Charles': 'Cardona', 'NVWM LLC': 'NVWM', 'Parkside Financial Bank & Trust': 'Parkside', 'Bogart Wealth LLC': 'Bogart', 'Byrne Asset Management LLC': 'Byrne', 'Elequin Capital LP': 'Elequin', 'Bulldog Investors LLP': 'Bulldog', 'Teachers Insurance & Annuity Assoc': 'Teachers', 'Aspiriant LLC': 'Aspiriant', 'PFS Partners LLC': 'PFS', 'Bridgewater Advisors Inc': 'Bridgewater', 'Gridiron Partners LLC': 'Gridiron', 'Capital Market Strategies LLC': 'Capital', 'Geneos Wealth Management Inc': 'Geneos', 'Camelot Portfolios LLC': 'Camelot', 'Relyea Zuckerberg Hanson LLC': 'Relyea', 'Aviance Capital Partners LLC': 'Aviance', 'Lexaurum Advisors LLC': 'Lexaurum', 'Novak & Powell Financial Services': 'Novak', 'Cedar Brook Financial Partners LLC': 'Cedar', 'MidWestOne Financial Group Inc': 'MidWestOne', 'Clear Creek Financial Management L': 'Clear', 'Wealthcare Advisory Partners LLC': 'Wealthcare', 'Washington Trust Advisors Inc': 'Washington', 'Gilliland Jeter Wealth Management': 'Gilliland', 'Prestige Wealth Management Group L': 'Prestige', 'Briaud Financial Planning Inc': 'Briaud', 'Scarborough Advisors LLC': 'Scarborough', 'Citigroup Inc': 'Citigroup', 'Indie Asset Partners LLC': 'Indie', 'SeaCrest Wealth Management LLC': 'SeaCrest', 'Park National Corp': 'Park', 'Fairhaven Wealth Management LLC': 'Fairhaven', 'RPO LLC': 'RPO', 'Boothbay Fund Management LLC': 'Boothbay', 'Atria Wealth Solutions Inc': 'Atria', 'Manulife Financial Corp': 'Manulife', 'Pacific Wealth Strategies Group In': 'Pacific', 'Evoke Wealth LLC': 'Evoke', 'Empower Advisory Group LLC': 'Empower', 'Core Wealth Partners LLC': 'Core', 'Clay Northam Wealth Management LLC': 'Clay', 'Everett Harris & Co': 'Everett', 'Mercer Global Advisors Inc': 'Mercer', 'Vanguard Capital Wealth Advisors L': 'Vanguard', 'Great Valley Advisor Group Inc': 'Great', 'Taddei Ludwig & Associates Inc': 'Taddei', 'Mirador Capital Partners LP': 'Mirador', 'RB Capital Management LLC': 'RB', 'First Foundation Advisors LLC': 'First', 'TriaGen Wealth Management LLC': 'TriaGen', 'Mine & Arao Wealth Creation & Mana': 'Mine', 'Cherry Tree Wealth Management LLC': 'Cherry', 'Truvestments Capital LLC': 'Truvestments', 'Aristides Capital LLC': 'Aristides', 'Westchester Capital Management LLC': 'Westchester', 'Flow State Investments LP': 'Flow', 'Cresta Advisors Ltd': 'Cresta', 'Jupiter Wealth Management LLC': 'Jupiter', 'Petra Financial Advisors Inc': 'Petra', 'TrinityPoint Wealth LLC': 'TrinityPoint', 'Childress Capital Advisors LLC': 'Childress', 'KIM LLC': 'KIM', 'WesBanco Bank Inc': 'WesBanco', 'Naples Global Advisors LLC': 'Naples', 'Edmonds Duncan Registered Investme': 'Edmonds', 'Tectonic Advisors LLC': 'Tectonic', 'Davenport & Co LLC': 'Davenport', 'Bard Financial Services Inc': 'Bard', 'Altus Wealth Group LLC': 'Altus', 'First Personal Financial Services': 'First', 'Lazari Capital Management Inc': 'Lazari', 'MYeCFO LLC': 'MYeCFO', 'Brave Asset Management Inc': 'Brave', 'Redhawk Wealth Advisors Inc': 'Redhawk', 'Sentinus LLC': 'Sentinus', 'Jackson National Asset Management': 'Jackson', 'Breakwater Capital Group LLC': 'Breakwater', 'Rock Point Advisors LLC': 'Rock', 'Venture Visionary Partners LLC': 'Venture', 'LJ Altfest & Co Inc': 'LJ', 'Summit Financial Wealth Advisors L': 'Summit', 'Successful Portfolios LLC': 'Successful', 'Stephens Inc': 'Stephens', 'Paul Damon and Associates Inc': 'Paul', 'AllianceBernstein Holding LP': 'AllianceBernstein', 'EMFO LLC': 'EMFO', 'Good Life Advisors LLC': 'Good', 'HRT Financial LP': 'HRT', 'SkyView Investment Advisors LLC': 'SkyView', 'IEQ Capital LLC': 'IEQ', 'MGO One Seven LLC': 'MGO', 'Kestra Private Wealth Services LLC': 'Kestra', 'Hudson Valley Investment Advisors': 'Hudson', 'Schechter Investment Advisors LLC': 'Schechter', 'Aberdeen Wealth Management LLC': 'Aberdeen', 'Toth Financial Advisory Corp': 'Toth', 'Moloney Securities Asset Managemen': 'Moloney', 'Sigma Planning Corp': 'Sigma', 'Financial Engines Advisors LLC': 'Financial', 'PFG Advisors LLC': 'PFG', 'Investors Asset Management of Geor': 'Investors', 'MBA Advisors LLC': 'MBA', 'Wealthspire Advisors LLC': 'Wealthspire', 'Pointe Capital Management LLC': 'Pointe', 'MB Generational Wealth LLC': 'MB', 'Armor Investment Advisors LLC': 'Armor', 'Apeiron RIA LLC': 'Apeiron', 'Hartline Investment Corp': 'Hartline', 'BAY Colony Advisory Group Inc': 'BAY', 'Seed Wealth Management Inc': 'Seed', 'Seelaus Asset Management LLC': 'Seelaus', 'Avantax Advisory Services Inc': 'Avantax', 'Sovereign Financial Group Inc': 'Sovereign', 'Citizens National Bank Trust Depar': 'Citizens', 'Founders Financial Alliance LLC': 'Founders', 'Csenge Advisory Group LLC': 'Csenge', 'LM Kohn & Co': 'LM', 'Total Clarity Wealth Management In': 'Total', 'JW Cole Advisors Inc': 'JW', 'Williams Jones Wealth Management L': 'Williams', 'Private Wealth Partners LLC': 'Private', 'InterOcean Capital Group LLC': 'InterOcean', 'M&T Bank Corp': 'M&T', 'Acorn Wealth Advisors LLC': 'Acorn', 'Strategies Wealth Advisors LLC': 'Strategies', 'Pinnacle Wealth Planning Services': 'Pinnacle', 'Apollon Wealth Management LLC': 'Apollon', 'Clean Yield Group Inc/The': 'Clean', 'Cutler Investment Counsel LLC': 'Cutler', 'Busey Wealth Management Inc': 'Busey', 'WealthBridge Capital Management LL': 'WealthBridge', 'Leisure Capital Management Inc': 'Leisure', 'Future Financial Wealth Managment': 'Future', 'Jones Financial Cos LLLP/The': 'Jones', 'Lamb David J': 'Lamb', 'American National Bank & Trust/Wic': 'American', 'SJS Investment Consulting Inc': 'SJS', 'Cornerstone Planning Group LLC': 'Cornerstone', 'Fortitude Family Office LLC': 'Fortitude', 'First Community Trust NA': 'First', 'Asset Dedication LLC': 'Asset', 'Pinnacle Bancorp Inc': 'Pinnacle', 'Main Management LLC': 'Main', 'Washington Trust Co of Westerly/Th': 'Washington', 'Cambridge Trust Co': 'Cambridge', 'Roble Belko and Co Inc': 'Roble', 'West Paces Advisors LLC': 'West', 'NBC Securities Inc': 'NBC', 'Capital Analysts LLC': 'Capital', 'Farmers and Merchants Trust Co of': 'Farmers', 'Sageview Advisory Group LLC': 'Sageview', 'YHB Investment Advisors Inc': 'YHB', 'Tyler-Stone Wealth Management LLC': 'Tyler-Stone', 'Hilltop National Bank': 'Hilltop', 'M&R Capital Management Inc': 'M&R', 'Hexagon Capital Partners LLC': 'Hexagon', 'Piscataqua Savings Bank': 'Piscataqua', 'Huntington National Bank/The': 'Huntington', 'Moisand Fitzgerald Tamayo LLC': 'Moisand', 'Householder Group Estate and Retir': 'Householder', 'Creekmur Asset Management LLC': 'Creekmur', 'Larson Financial Group LLC': 'Larson', 'Hanson & Doremus Investment Manage': 'Hanson', 'Barrett & Co': 'Barrett', 'DiNuzzo Private Wealth Inc': 'DiNuzzo', 'Richard W Paul & Associates LLC': 'Richard', 'Fisher Asset Management LLC': 'Fisher', 'Jane Street Group LLC': 'Jane', 'Farmers & Merchants Investment Inc': 'Farmers', 'McGlone Suttner Wealth Management': 'McGlone', 'Turtle Creek Wealth Advisors LLC': 'Turtle', 'Hilltop Holdings Inc': 'Hilltop', 'Sound View Wealth Advisors Group L': 'Sound', 'Strategic Financial Concepts LLC': 'Strategic', 'Lauterbach Financial Advisors LLC': 'Lauterbach', 'Greytown Advisors Inc': 'Greytown', 'Nations Financial Group Inc': 'Nations', 'Sowell Financial Services LLC': 'Sowell', 'Maple Valley Mutual Insurance': 'Maple', 'Christian Romaglino': 'Christian', 'BOK Financial Private Wealth Inc': 'BOK', 'Phillip Soccio': 'Phillip', 'Whitebox Advisors LLC': 'Whitebox', 'Ignite Planners LLC': 'Ignite', 'Regatta Capital Group LLC': 'Regatta', 'Davidson Trust Co': 'Davidson', 'Southland Equity Partners LLC': 'Southland', 'Prime Capital Investment Advisors': 'Prime', 'Van Hulzen Asset Management LLC': 'Van', 'Apriem Advisors': 'Apriem', 'Oder Investment Management LLC': 'Oder', 'Cooper Financial Group': 'Cooper', 'Aquire Wealth Advisors LLC': 'Aquire', 'RHS Financial LLC': 'RHS', 'International Assets Investment Ma': 'International', 'Castle Rock Wealth Management LLC': 'Castle', 'MKT Advisors LLC': 'MKT', 'Obermeyer Wood Investment Counsel': 'Obermeyer', 'First American Trust FSB': 'First', 'NEW Insight Wealth Advisors': 'NEW', 'Pure Financial Advisors Inc': 'Pure', 'Perigon Wealth Management LLC': 'Perigon', 'Weaver Consulting Group LLC': 'Weaver', 'Grassi Investment Management LLC': 'Grassi', 'EP Wealth Advisors LLC': 'EP', 'Gerber Kawasaki Inc': 'Gerber', 'Perennial Investment Advisors LLC': 'Perennial', 'Fermata Advisors LLC': 'Fermata', 'Riverview Trust Co': 'Riverview', 'Strategic Advocates LLC': 'Strategic', 'EWG Elevate Inc': 'EWG', 'Sanders Morris Harris LLC': 'Sanders', 'Provence Wealth Management Group I': 'Provence', 'Covestor Ltd': 'Covestor', 'Creative Capital Management Invest': 'Creative', 'BFSG LLC': 'BFSG', 'DB Wealth Management Group LLC': 'DB', 'Axxcess Wealth Management LLC': 'Axxcess', 'HoyleCohen LLC': 'HoyleCohen', 'Beach Point Capital Management LP': 'Beach', 'Nalls Sherbakoff Group LLC/The': 'Nalls', 'NWAM LLC': 'NWAM', 'Tidemark LLC': 'Tidemark', 'Pensionmark Financial Group LLC': 'Pensionmark', '1607 Capital Partners LLC': '1607', 'Round Rock Advisors LLC': 'Round', 'Concorde Asset Management LLC': 'Concorde', 'Belpointe Asset Management LLC': 'Belpointe', 'Kennedy Investment Group Inc': 'Kennedy', 'Alpine Global Management LLC': 'Alpine', 'Thrivent Financial for Lutherans': 'Thrivent', 'Johnson Financial Group Inc': 'Johnson', 'InTrack Investment Management Inc': 'InTrack', 'Goldman Sachs Group Inc/The': 'Goldman', 'Pallas Capital Advisors LLC': 'Pallas', 'Pinnacle Associates Ltd': 'Pinnacle', 'Signature Estate & Investment Advi': 'Signature', 'Texas Capital Bank Wealth Manageme': 'Texas', 'Richmond Brothers Inc': 'Richmond', 'Oxbow Advisors LLC': 'Oxbow', 'Sonora Investment Management Group': 'Sonora', 'Rinkey Investments': 'Rinkey', 'Mathes Co Inc/The': 'Mathes', 'Visionary Wealth Advisors LLC': 'Visionary', 'Daymark Wealth Partners LLC': 'Daymark', 'Wealth Dimensions Group Ltd': 'Wealth', 'Millennium Management LLC/NY': 'Millennium', 'Saxony Capital Management LLC': 'Saxony', 'Powell Investment Advisors LLC': 'Powell', 'Chapin Davis Inc': 'Chapin', 'Manufacturing Technology Mutual In': 'Manufacturing', 'Pettinga Financial Advisors LLC': 'Pettinga', 'First Merchants Corp': 'First', 'Commerce Bank/Kansas City MO': 'Commerce', 'WMG Financial Advisors LLC': 'WMG', 'Equitable Holdings Inc': 'Equitable', 'Vista Investment Management LLC': 'Vista', 'Next Capital Management LLC': 'Next', 'Prosperity Wealth Management Inc': 'Prosperity', 'Sevenbridge Financial Group LLC': 'Sevenbridge', 'Peapack-Gladstone Financial Corp': 'Peapack-Gladstone', 'STA Wealth Management LLC': 'STA', 'Bank of New Hampshire': 'Bank', 'Anchor Investment Management LLC': 'Anchor', 'Pinnacle Financial Partners Inc': 'Pinnacle', 'Community Bank NA/Dewitt NY': 'Community', 'JNBA Financial Advisors Inc': 'JNBA', 'Sound Income Strategies LLC': 'Sound', 'Northwest Bank & Trust Co/Davenpor': 'Northwest', 'Field & Main Bank Inc': 'Field', 'CoreFirst Bank & Trust': 'CoreFirst', 'Mather Group LLC/The': 'Mather', 'Ameliora Wealth Management AG': 'Ameliora', 'Winch Advisory Services LLC': 'Winch', 'CVA Family Office LLC': 'CVA', 'Massmutual Trust Co/The': 'Massmutual', 'BAM Advisor Services LLC': 'BAM', 'Von Berge Wealth Management Group': 'Von', 'Gradient Investments LLC': 'Gradient', 'Annex Advisory Services LLC': 'Annex', 'SFI Advisors LLC': 'SFI', 'RMR Wealth Builders Inc': 'RMR', 'Sea Otter Advisors LLC': 'Sea', 'REDW Stanley Financial Advisors LL': 'REDW', 'BlackRock Inc': 'BlackRock', 'Seamount Financial Group Inc': 'Seamount', 'Penbrook Management LLC': 'Penbrook', 'Madison Park Capital Advisors LLC': 'Madison', 'Beverly Hills Private Wealth LLC': 'Beverly', 'Atlanta Consulting Group Advisors': 'Atlanta', 'Modera Wealth Management LLC': 'Modera', 'Pin Oak Investment Advisors Inc': 'Pin', 'Tony Wong': 'Tony', 'Richardson Financial Services': 'Richardson', 'Planning Capital Management Corp': 'Planning', 'AssetMark Inc': 'AssetMark', 'NCM Capital Management LLC': 'NCM', 'Laird Norton Wetherby Wealth Manag': 'Laird', 'Centaurus Financial Inc': 'Centaurus', '180 Wealth Advisors LLC': '180', 'WealthTrust Axiom LLC': 'WealthTrust', 'Verdence Capital Advisors LLC': 'Verdence', 'Mission Creek Capital Partners Inc': 'Mission', 'Ronald Blue Trust Inc': 'Ronald', 'Fusion Investment Advisors LLC': 'Fusion', 'Parkside Investments LLC': 'Parkside', 'Private Wealth Strategies LLC': 'Private', 'KeyCorp': 'KeyCorp', 'Balanced Wealth Group LLC': 'Balanced', 'Inscription Capital LLC': 'Inscription', 'Turner Marshall C': 'Turner', 'Pacifica Partners Inc': 'Pacifica', 'Russell Investments Group Ltd': 'Russell', 'Moody Garry L': 'Moody', 'True Private Wealth Advisors LLC': 'True', 'Townsquare Capital LLC': 'Townsquare', 'Park Place Capital Corp': 'Park', 'XTX Topco Ltd': 'XTX', 'Virtus Investment Partners Inc': 'Virtus', 'Davis Investment Partners LLC': 'Davis', 'Atomi Financial Group Inc': 'Atomi', 'First Interstate Bank/Billings MT': 'First', 'Live Oak Private Wealth LLC': 'Live', 'Quent Capital LLC': 'Quent', 'Sugarloaf Wealth Management LLC': 'Sugarloaf', 'Central Pacific Bank': 'Central', 'Costello Asset Management Inc': 'Costello', 'IAG Wealth Partners LLC': 'IAG', 'Financial Perspectives Inc': 'Financial', 'GoalVest Advisory LLC': 'GoalVest', 'Quadrature Capital Ltd': 'Quadrature', 'Greatmark Investment Partners Inc': 'Greatmark', 'AHL Investment Management Inc': 'AHL', 'Renasant Bank/Tupelo MS': 'Renasant', 'Lake Street Financial LLC': 'Lake', 'FF Advisors LLC': 'FF', 'Primoris Wealth Advisors LLC': 'Primoris', 'Kovack Advisors Inc': 'Kovack', 'Regal Investment Advisors LLC': 'Regal', 'Edgemoor Investment Advisors Inc': 'Edgemoor', 'Murphy Middleton Hinkle & Parker I': 'Murphy', 'Beacon Pointe Advisors LLC': 'Beacon', 'C2P Capital Advisory Group LLC': 'C2P', 'James Investment Research Inc': 'James', 'Hayek Kallen Investment Management': 'Hayek', 'Meadow Creek Wealth Advisors LLC': 'Meadow', 'Hancock Whitney Corp': 'Hancock', 'Shulman DeMeo Asset Management LLC': 'Shulman', 'Lantz Financial LLC': 'Lantz', 'Burford Brothers Inc': 'Burford', 'Vista Private Wealth Partners LLC': 'Vista', 'Commonwealth Financial Services LL': 'Commonwealth', 'Linscomb & Williams Inc': 'Linscomb', 'PSI Advisors LLC': 'PSI', 'Optimum Investment Advisors LLC': 'Optimum', 'Beacon Capital Management LLC': 'Beacon', 'Chilton Capital Management LLC': 'Chilton', 'EverSource Wealth Advisors LLC': 'EverSource', 'St Johns Investment Management Co': 'St', 'Clearstead Advisors LLC': 'Clearstead', 'GHP Investment Advisors Inc': 'GHP', 'CBIZ Investment Advisory Services': 'CBIZ', 'Retirement Group LLC': 'Retirement', 'Main Street Group Ltd': 'Main', 'United Community Bank': 'United', 'Schaper Benz & Wise Investment Cou': 'Schaper', 'Sawtooth Asset Management Inc': 'Sawtooth', 'Narwhal Capital Management LLC': 'Narwhal', 'Synovus Financial Corp': 'Synovus', 'Mosaic Family Wealth Partners LLC': 'Mosaic', 'Stratos Wealth Advisors LLC': 'Stratos', 'Capstone Capital Wealth Advisors': 'Capstone', 'Access Financial Services Inc': 'Access', 'Bison Wealth LLC': 'Bison', 'PROVIDENCE FIRST TRUST CO': 'PROVIDENCE', 'Institutional and Family Asset Man': 'Institutional', 'Independence Bank of Kentucky': 'Independence', 'FinTrust Capital Advisors LLC': 'FinTrust', 'Guardian Wealth Management Inc/IL': 'Guardian', 'Scissortail Wealth Management LLC': 'Scissortail', 'Charger Corp/The': 'Charger', 'Dynamic Advisor Solutions LLC': 'Dynamic', 'Williams & Novak LLC': 'Williams', 'Christian Stracke': 'Christian', 'Caldwell Sutter Capital Inc': 'Caldwell', 'Tempus Wealth Planning LLC': 'Tempus', 'Well Done LLC': 'Well', 'Secure Asset Management LLC': 'Secure', 'Transcend Wealth Collective LLC': 'Transcend', 'Foresight Capital Management Advis': 'Foresight', 'Mason & Associates LLC': 'Mason', 'Capital Asset Advisory Services LL': 'Capital', 'Liberty Capital Management Inc/MI': 'Liberty', 'Jacobi Capital Management LLC': 'Jacobi', 'Ethos Financial Group LLC': 'Ethos', 'Johnson & White Wealth Management': 'Johnson', 'Haverford Trust Co/Radnor PA': 'Haverford', 'BLB&B Advisors LLC': 'BLB&B', 'Ambassador Advisors LLC': 'Ambassador', 'KEY Financial Inc': 'KEY', 'Bare Financial Services Inc': 'Bare', 'First Manhattan Co LLC': 'First', 'Focused Wealth Management Inc': 'Focused', 'Two Sigma Investments LP': 'Two', 'McClarren Financial Advisors Inc': 'McClarren', 'Art Group Services Ltd': 'Art', 'Financial Network Wealth Managemen': 'Financial', 'Omni 360 Wealth Inc': 'Omni', 'Circle Wealth Management LLC': 'Circle', 'Frisch Financial Group Inc': 'Frisch', 'Tompkins Financial Corp': 'Tompkins', 'Lazard Inc': 'Lazard', 'Baker Avenue Asset Management LP': 'Baker', 'Dopkins Wealth Management LLC': 'Dopkins', 'MAI Capital Management LLC': 'MAI', 'Opinicus Capital Inc': 'Opinicus', 'TSFG LLC': 'TSFG', 'Blue Zone Wealth Advisors LLC': 'Blue', 'Strait & Sound Wealth Management L': 'Strait', 'Ehrlich Group LLC\\The': 'Ehrlich', 'Camelot Technology Advisors Inc': 'Camelot', 'Westside Investment Management Inc': 'Westside', 'Blume Capital Management Inc': 'Blume', 'Lawyers Mutual Liability Insurance': 'Lawyers', 'Plante Moran Financial Advisors LL': 'Plante', 'Cape Investment Advisory Inc': 'Cape', 'MacroView Investment Management LL': 'MacroView', 'TNF LLC': 'TNF', 'Trust Co/Kansas': 'Trust', 'Frazier Financial Advisors LLC': 'Frazier', 'SA Mason LLC': 'SA', 'Benjamin Edwards Inc': 'Benjamin', 'Kiely Wealth Advisory Group Inc': 'Kiely', 'Roepke Maryanne L': 'Roepke', 'Kempner Capital Management Inc': 'Kempner', 'Sar Wealth Management Group LLC': 'Sar', 'ICON Advisers Inc': 'ICON', 'WealthTrust Asset Management LLC': 'WealthTrust', 'Red Tortoise LLC': 'Red', 'United Advisor Group LLC': 'United', 'Pineridge Advisors LLC': 'Pineridge', 'Michael Kalinoski': 'Michael', 'First PREMIER Bank': 'First', 'Venturi Wealth Management LLC': 'Venturi', 'GM Advisory Group Inc': 'GM', 'Tidal Investments LLC': 'Tidal', 'Brown Brothers Harriman & Co': 'Brown', 'Credit Suisse Group AG': 'Credit', 'Cutler Capital Management LLC': 'Cutler', 'High Note Wealth LLC': 'High', 'Zullo Investment Group Inc': 'Zullo', 'Creative Financial Designs Inc': 'Creative', 'Fairfield Bush & Co': 'Fairfield', 'Icon Wealth Advisors LLC': 'Icon', 'WG Shaheen & Associates Ltd': 'WG', 'Arnhold LLC': 'Arnhold', 'Joel Isaacson & Co LLC': 'Joel', 'Chemistry Wealth Management LLC': 'Chemistry', 'Avestar Capital LLC': 'Avestar', 'Northeast Financial Consultants LL': 'Northeast', 'Toronto-Dominion Bank/The': 'Toronto-Dominion', 'Intellectus Partners LLC': 'Intellectus', 'Channel Wealth LLC': 'Channel', 'Destination Wealth Management Inc': 'Destination', 'Cypress Wealth Services LLC': 'Cypress', 'Ritholtz Wealth Management LLC': 'Ritholtz', 'Litman Gregory Wealth Management L': 'Litman', 'Golden State Equity Partners LLC': 'Golden', 'Wealthcollab LLC': 'Wealthcollab', 'Brewin Dolphin Holdings Ltd': 'Brewin', 'Woodward Diversified Capital LLC': 'Woodward', 'AlphaCentric Advisors LLC': 'AlphaCentric', 'Brandywine Oak Private Wealth LLC': 'Brandywine', 'Monongahela Capital Management Inc': 'Monongahela', 'Grant Street Asset Management Inc': 'Grant', 'IFG Advisors LLC': 'IFG', 'Transcendent Capital Group LLC': 'Transcendent', 'Element Pointe Advisors LLC': 'Element', "Tim O'Reilly": 'Tim', 'Wealth Quarterback LLC': 'Wealth', 'Wagner Wealth Management LLC': 'Wagner', 'Quarry LP/The': 'Quarry', 'Carolinas Wealth Consulting LLC': 'Carolinas', 'Investors Research Corp': 'Investors', 'SignatureFD LLC': 'SignatureFD', 'Kozak & Tripp Pvt Asset Management': 'Kozak', 'Clough Capital Partners LP': 'Clough', 'Planned Solutions Financial & Insu': 'Planned', 'Clear Point Advisors Inc': 'Clear', 'Private Portfolio Partners LLC': 'Private', 'Jaeckel Ted': 'Jaeckel', 'Wealth Effects LLC': 'Wealth', 'SAX Wealth Advisors LLC': 'SAX', 'Philadelphia Trust Co/The': 'Philadelphia', 'Hayes Peter J': 'Hayes', 'Gladstone Institutional Advisory L': 'Gladstone', 'Dumont & Blake Investment Advisors': 'Dumont', 'Princeton Global Asset Management': 'Princeton', "Walter O'Connor": 'Walter', 'Private Wealth Management Group LL': 'Private', 'Kevin Maloney': 'Kevin', 'Sykon Capital LLC': 'Sykon', 'CSS LLC': 'CSS', 'HBK Sorce Advisory LLC': 'HBK', 'Smallwood Wealth Investment Manage': 'Smallwood', 'Goodman Advisory Group LLC': 'Goodman', 'American National Bank & Trust Co/': 'American', 'Dudley Capital Management LLC': 'Dudley', 'Smith Salley & Associates LLC': 'Smith', 'Modern Wealth Management LLC/KS': 'Modern', 'Grace & White Inc': 'Grace', 'Hubbard Robert Glenn': 'Hubbard', 'Cavanagh Richard Edward': 'Cavanagh', 'Castellano Michael J': 'Castellano', 'Capital Group Cos Inc/The': 'Capital', 'Marks Group Wealth Management Inc': 'Marks', 'Mairs & Power Inc': 'Mairs', 'Tradition Wealth Management LLC': 'Tradition', 'Hohimer Wealth Management LLC': 'Hohimer', 'Garden State Investment Advisory S': 'Garden', 'Onyx Bridge Wealth Group LLC': 'Onyx', 'Flagship Harbor Advisors LLC': 'Flagship', 'TBH Global Asset Management LLC': 'TBH', 'Encompass Wealth Advisors LLC': 'Encompass', 'Total Investment Management Inc': 'Total', 'Alterity Financial Group LLC': 'Alterity', 'Kester Carl W': 'Kester', 'Fabozzi Frank J': 'Fabozzi', 'Lindbrook Capital LLC': 'Lindbrook', 'Union Savings Bank/Danbury CT': 'Union', 'Garner Asset Management Corp': 'Garner', 'Moran Eileen A': 'Moran', 'David Grumhaus': 'David', 'McNamara Geraldine M': 'McNamara', 'McLoughlin Philip R': 'McLoughlin', 'Burke Donald C': 'Burke', 'Azimuth Capital Investment Managem': 'Azimuth', 'Planning Alternatives Ltd': 'Planning', 'Apcm Wealth Management For Individ': 'Apcm', 'Capital Wealth Alliance LLC': 'Capital', 'Berkeley Capital Partners LLC': 'Berkeley', 'Collaborative Wealth Management In': 'Collaborative', 'Compass Wealth Management LLC/CT': 'Compass', 'CM Bidwell & Associates Ltd': 'CM', 'Flagship Private Wealth LLC': 'Flagship', 'Allegheny Financial Group Ltd': 'Allegheny', 'Welch & Forbes LLC': 'Welch', 'E&G Advisors LP': 'E&G', 'Oarsman Capital Inc': 'Oarsman', 'Genesee Capital Advisors LLC': 'Genesee', 'Mystic Asset Management Inc': 'Mystic', 'Quadrant Private Wealth Management': 'Quadrant', 'FWL Investment Management LLC': 'FWL', 'City National Bank/Los Angeles CA': 'City', 'Perilli Michael': 'Perilli', 'Coston Mcisaac and Partners Inc': 'Coston', 'Castleview Partners LLC': 'Castleview', 'Constitution Capital LLC/CT': 'Constitution', 'Noesis Capital Management Corp': 'Noesis', 'Zurich Investment Management Ltd/A': 'Zurich', 'Patron Partners Advisors LLC': 'Patron', 'Montgomery Investment Management I': 'Montgomery', 'Fernwood Investment Management LLC': 'Fernwood', 'Horizons Wealth Management Inc': 'Horizons', 'Nova R Wealth Inc': 'Nova', 'Wheelhouse Advisory Group LLC': 'Wheelhouse', 'Main Street Financial Solutions LL': 'Main', 'Sanctuary Wealth Management LLC': 'Sanctuary', 'Mariner Investment Group LLC': 'Mariner', 'Atticus Wealth Management LLC': 'Atticus', 'Canandaigua National Corp': 'Canandaigua', 'Lokken Investment Group LLC': 'Lokken', 'Herring Richard J': 'Herring', 'Hall Laurie J Trustee': 'Hall', 'Cito Capital Group LLC': 'Cito', 'SouthState Corp': 'SouthState', 'Donahue John Christopher': 'Donahue', 'Sentinel Trust Co LBA': 'Sentinel', 'Amplius Wealth Advisors LLC': 'Amplius', 'Waterfront Wealth Inc': 'Waterfront', 'Eldridge Investment Advisors Inc': 'Eldridge', 'Maltin Wealth Management Inc': 'Maltin', 'Jefferies Financial Group Inc': 'Jefferies', 'Andrew Hill Investment Advisors In': 'Andrew', 'Covenant Asset Management LLC': 'Covenant', 'Tamar Securities LLC': 'Tamar', 'MGB Wealth Management LLC': 'MGB', 'Edge Wealth Management LLC': 'Edge', 'Smartleaf Asset Management LLC': 'Smartleaf', 'Strategic Wealth Designers LLC': 'Strategic', 'Imprint Wealth LLC': 'Imprint', 'Colonial Trust Co': 'Colonial', 'Ritter Daniher Financial Advisory': 'Ritter', 'Crewe Advisors LLC': 'Crewe', 'ROSENBERG MATTHEW HAMILTON': 'ROSENBERG', 'WhaleRock Point Partners LLC': 'WhaleRock', 'JGP Wealth Management LLC': 'JGP', 'Verus Capital Partners LLC': 'Verus', 'First indemnity of America Insuran': 'First', 'NewEdge Wealth LLC': 'NewEdge', 'Craig Brandon': 'Craig', 'Pflug Koory LLC': 'Pflug', 'Todd Asset Management LLC': 'Todd', 'HFG Advisors Inc': 'HFG', 'Centennial Wealth Advisory LLC': 'Centennial', 'Dan Lippincott': 'Dan', 'Peoples Financial Services Corp': 'Peoples', 'DHJJ Financial Advisors Ltd': 'DHJJ', 'West Branch Capital LLC': 'West', 'Continuum Advisory LLC': 'Continuum', 'VitalStone Financial LLC': 'VitalStone', 'Fiducian Portfolio Services Ltd': 'Fiducian', 'Cogan Sarah Edwards': 'Cogan', 'Fortis Group Advisors LLC': 'Fortis', 'Carnegie Capital Asset Management': 'Carnegie', 'Galley Patrick W': 'Galley', '&Partners LLC/TN': '&Partners', 'Mosaic Financial Group LLC/The': 'Mosaic', 'Robert DiMella': 'Robert', "Stephen O'Neill": 'Stephen', 'HUTCHENS JOHN WAYNE': 'HUTCHENS', 'BlackDiamond Wealth Management Inc': 'BlackDiamond', 'Scott Sprauer': 'Scott', 'Ascent Wealth Partners LLC': 'Ascent', 'Perry Michael A': 'Perry', 'Stockman Wealth Management Inc': 'Stockman', 'David J Yvars Group Inc/The': 'David', 'Opal Wealth Advisors LLC': 'Opal', 'Valley Wealth Managers Inc': 'Valley', 'Rockbridge Investment Management L': 'Rockbridge', 'Americana Partners LLC': 'Americana', 'WESPAC Advisors LLC': 'WESPAC', 'Calamos Partners LLC': 'Calamos', 'First National Trust Co': 'First', 'Laffer Tengler Investments Inc': 'Laffer', 'Salem Investment Counselors Inc': 'Salem', 'Retirement Planning Co of New Engl': 'Retirement', 'Canton of Vaud': 'Canton', 'Fort Sheridan Advisors LLC': 'Fort', 'McIlrath & Eck LLC': 'McIlrath', 'Alethea Capital Management LLC': 'Alethea', 'Madrona Financial Services LLC': 'Madrona', 'Albion Management Group Ltd': 'Albion', 'Mahurkar Sakharam D': 'Mahurkar', 'Traphagen Investment Advisors LLC': 'Traphagen', 'Chiron Capital Management LLC': 'Chiron', 'Koss-Olinger Consulting LLC': 'Koss-Olinger', 'Palumbo Wealth Management LLC': 'Palumbo', 'Perkins Coie Trust Co': 'Perkins', 'Baker Tilly Financial LLC': 'Baker', 'Mechanics Bank Trust Department': 'Mechanics', 'Jason Steiner': 'Jason', 'Cozad Asset Management Inc': 'Cozad', 'Twelve Points Wealth Management LL': 'Twelve', 'Frost Cynthia': 'Frost', 'Arcadia Investment Management Corp': 'Arcadia', 'National Bank of Canada': 'National', 'Western Pacific Wealth Management': 'Western', '1st Source Bank/South Bend IN': '1st', 'Cooper Aaron M': 'Cooper', 'ARS Wealth Advisors Group LLC': 'ARS', 'Private Wealth Advisors LLC': 'Private', 'Singh Manoj P': 'Singh', 'Pillai Marie': 'Pillai', 'High Net Worth Advisory Group LLC/': 'High', 'Traynor Capital Management Inc': 'Traynor', 'Running Point Capital Advisors LLC': 'Running', 'Summit X LLC': 'Summit', 'Waterloo Capital LP': 'Waterloo', 'Principle Wealth Partners LLC': 'Principle', 'Level Four Advisory Services LLC': 'Level', 'Arkadios Wealth Advisors LLC': 'Arkadios', 'Financial Security Advisory Inc': 'Financial', 'Diversify Advisory Services LLC': 'Diversify', 'Moschner Albin F': 'Moschner', 'Manchester Capital Management LLC': 'Manchester', 'Mattern Wealth Management LLC': 'Mattern', 'Stewardship Advisors LLC': 'Stewardship', 'Lee Financial Corp': 'Lee', 'Financial Counselors Inc': 'Financial', 'Schwarz Dygos Wheeler Investment A': 'Schwarz', 'Dorsey & Whitney Trust Co LLC': 'Dorsey', 'Deroy & Devereaux Private Investme': 'Deroy', 'Meridian Investment Counsel Inc': 'Meridian', 'HBK Investments LP': 'HBK', 'Prudent Investors Network Inc': 'Prudent', 'Raio Jerry': 'Raio', 'Michael Denlinger': 'Michael', 'Smithfield Trust Co': 'Smithfield', 'Riggs Asset Management Co Inc': 'Riggs', 'John Lawlor': 'John', 'Insight Wealth Strategies LLC': 'Insight', 'Titleist Asset Management LLC': 'Titleist', 'Nottingham Advisors Inc': 'Nottingham', 'First City Capital Management Inc': 'First', 'Graves Light Lenhart Wealth Inc': 'Graves', 'Robards Karen P': 'Robards', 'Trust Co Of Vermont': 'Trust', 'Retirement Planning Group Inc/The': 'Retirement', 'Legacy Financial Strategies LLC': 'Legacy', 'Keudell Morrison Wealth Management': 'Keudell', 'Trustmark National Bank Trust Depa': 'Trustmark', 'Joseph P Lucia & Associates LLC': 'Joseph', 'Financial Advocates Investment Man': 'Financial', 'United Bank/Zebulon GA': 'United', 'Procyon Advisors LLC': 'Procyon', 'HTLF Bank': 'HTLF', 'Family Asset Management LLC': 'Family', 'United Capital Financial Advisers': 'United', 'Ruedi Wealth Management Inc': 'Ruedi', 'City Holding Co': 'City', 'Sutphen Mona K': 'Sutphen', 'Disciplined Equity Management Inc': 'Disciplined', 'Beta Wealth Group Inc': 'Beta', 'Centurion Wealth Management LLC': 'Centurion', 'Wealthstream Advisors Inc': 'Wealthstream', 'HBC Financial Services PLLC': 'HBC', 'Rappaport Alan H': 'Rappaport', 'Coombe Bender & Co LLC': 'Coombe', 'California First Leasing Corp': 'California', 'Romaglino Christian': 'Romaglino', 'SIG HOLDING LLC': 'SIG', 'Sontag Advisory LLC': 'Sontag', 'Johnson Investment Counsel Inc': 'Johnson', 'Kaizen Financial Strategies LLC': 'Kaizen', 'Missouri Trust & Investment Co': 'Missouri', 'Mougin Lisa': 'Mougin', 'Creativeone Wealth LLC': 'Creativeone', 'Schmucker Brian': 'Schmucker', 'Granby Capital Management LLC': 'Granby', 'Tiedemann Advisors LLC': 'Tiedemann', 'Roman Butler Fullerton & Co': 'Roman', 'Cetera Financial Group Inc': 'Cetera', 'Shepherd Kaplan Krochuk LLC': 'Shepherd', 'WCG Wealth Advisors LLC': 'WCG', 'Resources Investment Advisors Inc': 'Resources', 'Disciplined Investments LLC': 'Disciplined', 'Wellington Shields Capital Managem': 'Wellington', 'Wilbanks Smith & Thomas Asset Mana': 'Wilbanks', 'DL Carlson Investment Group Inc': 'DL', 'Ballew Advisors Inc': 'Ballew', 'Wolff Financial Management LLC': 'Wolff', 'GYL Financial Synergies LLC': 'GYL', 'Vicus Capital Inc': 'Vicus', 'Second Half Financial Partners LLC': 'Second', 'Roundview Capital LLC': 'Roundview', 'Essential Planning LLC': 'Essential', 'BANK OF NEW YORK MELLON CORP/THE': 'BANK', 'Conning Inc': 'Conning', 'Keeley-Teton Advisors LLC': 'Keeley-Teton', 'IVC Wealth Advisors LLC': 'IVC', 'Clarity Financial LLC': 'Clarity', 'Glass Jacobson Investment Advisors': 'Glass', 'Glenview Trust Co/The': 'Glenview', 'PJ Schmidt Investment Management I': 'PJ', 'Marble Harbor Investment Counsel L': 'Marble', 'Heritage Investors Management': 'Heritage', 'Investment Research & Advisory Gro': 'Investment', 'Annapolis Financial Services LLC': 'Annapolis', 'Johnson Midwest Financial LLC': 'Johnson', 'MODERN CAPITAL MANAGEMENT CO': 'MODERN', 'Radnor Capital Management LLC': 'Radnor', 'Aries Wealth Management LLC': 'Aries', 'Valeo Financial Advisors LLC': 'Valeo', 'V Wealth Management LLC': 'V', 'Accel Wealth Management LLC': 'Accel', 'Segall Bryant & Hamill LLC': 'Segall', 'Authentikos Wealth Advisory LLC': 'Authentikos', 'Thomas E Faust Jr': 'Thomas', 'Investment Partners Ltd': 'Investment', 'Tanglewood Legacy Advisors LLC': 'Tanglewood', 'Addison Capital Co': 'Addison', 'BMC FUND INC': 'BMC', 'First National Bank in Sioux Falls': 'First', 'Schnieders Capital Management LLC': 'Schnieders', 'Merlin Capital LLC': 'Merlin', 'Atlantic Union Bankshares Corp': 'Atlantic', 'SR Schill & Associates Inc': 'SR', 'Journey Advisory Group LLC': 'Journey', 'Carl P Sherr & Co LLC': 'Carl', 'Perissos Private Wealth Management': 'Perissos', 'Benedetti & Gucer Timber LLC': 'Benedetti', 'Bryn Mawr Capital Management LLC': 'Bryn', 'Bankinter SA': 'Bankinter', 'MeadowBrook Investment Advisors LL': 'MeadowBrook', 'Reitz Capital Advisors LLC': 'Reitz', 'Graniteshares Advisors LLC': 'Graniteshares', 'Bruce G Allen Investments LLC': 'Bruce', 'Shaker Financial Services LLC': 'Shaker', 'Taylor Hoffman Wealth Management L': 'Taylor', 'Mayflower Financial Advisors LLC': 'Mayflower', 'Beaird Harris Wealth Management LL': 'Beaird', 'Beacon Bridge Wealth Partners LLC': 'Beacon', 'Morris Retirement Advisors LLC': 'Morris', 'Single Point Partners LLC': 'Single', 'Peak Asset Management LLC': 'Peak', 'Sweeney & Michel LLC': 'Sweeney', 'Fortress Wealth Management Inc': 'Fortress', 'Miracle Mile Advisors LLC': 'Miracle', 'Osborne Partners Capital Managemen': 'Osborne', 'Garrison Point Advisors LLC': 'Garrison', 'Cantor Fitzgerald Investment Advis': 'Cantor', 'Watts Gwilliam & Co LLC': 'Watts', 'Sterling Group Wealth Management L': 'Sterling', 'Bourgeon Capital Management LLC': 'Bourgeon', 'Claybrook Capital LLC': 'Claybrook', 'Hunter Perkins Capital Management': 'Hunter', 'Wetherby Asset Management': 'Wetherby', 'Cerity Partners LLC': 'Cerity', 'Bluesky Wealth Advisors LLC': 'Bluesky', 'CCG Wealth Management LLC': 'CCG', 'NATIONAL FINANCIAL SERVICES LLC': 'NATIONAL', 'Botty Investors LLC': 'Botty', 'LPF Advisors LLC': 'LPF', 'Rovin Capital LLC/UT': 'Rovin', 'Eudaimonia Partners LLC': 'Eudaimonia', 'Next Level Private LLC': 'Next', 'Paragon Wealth Strategies LLC': 'Paragon', 'Center for Financial Planning Inc': 'Center', 'Granite Bay Wealth Management LLC': 'Granite', 'Selway Asset Management Inc': 'Selway', 'Coldstream Capital Management Inc': 'Coldstream', 'Hudock Inc': 'Hudock', 'GHE LLC': 'GHE', 'NBT Bank NA': 'NBT', 'ACT Advisors LLC': 'ACT', 'FL Putnam Investment Management Co': 'FL', 'First National Bank & Trust Co of': 'First', 'Glenmede Trust Co NA/The': 'Glenmede', 'Windsor Wealth Management Inc': 'Windsor', 'Southern Capital Advisors LLC': 'Southern', 'Midwest Heritage Bank FSB': 'Midwest', 'Visionary Horizons LLC': 'Visionary', 'Essex Financial Services Inc/CT': 'Essex', 'HORIZON BANCORP': 'HORIZON', 'Stewart West Indies Trading Co Ltd': 'Stewart', 'Thompson Investment Management Inc': 'Thompson', 'Phoenix Wealth Advisors': 'Phoenix', 'Atlas Wealth LLC': 'Atlas', 'Woodline Partners LP': 'Woodline', 'Fountainhead AM LLC': 'Fountainhead', 'Credit Agricole Group': 'Credit', 'XCEL Wealth Management LLC': 'XCEL', 'JBR Co-Financial Management Inc': 'JBR', 'Locorr Fund Management LLC': 'Locorr', 'Invictus Private Wealth LLC': 'Invictus', 'King Wealth Management Group LLC': 'King', 'Toupin Ronald E': 'Toupin', 'Significant Wealth Partners LLC': 'Significant'}

import pandas as pd
import os
import xlwings as xw
from xlwings.utils import rgb_to_int
import re
from datetime import datetime

# File path for the input excel sheet
folder_path = "S:\\Balyan\\ClosedEndFundProject\\Input\\"
files = os.listdir(folder_path)

# Get file name and create file path
file_path = folder_path + files[0]

flagged_firms = ["Saba", "Karpus", "Bulldog", "Sit"]

df = pd.read_csv(file_path)

# Creates a new data frame containing information for only the three largest holders for a given ticker
top3_holders = df.groupby('Cusip').apply(lambda x: x.nlargest(3, 'shares_held'))[['Cusip','holder_name', 'shares_held', 'latest_chg']].reset_index(drop=True)

# Shortens holder names if they appear in the firm_names dictionary, otherwise doesn't shorten
top3_holders['holder_name'] = top3_holders['holder_name'].map(firm_names).fillna(top3_holders['holder_name'])

# Define a custom aggregation function to combine info for three largest holders into a single row
def combine_top3(group):
    holders = ', '.join(group['holder_name'])
    shares = ', '.join(group['shares_held'].astype(str))
    latest_chg = ', '.join(group['latest_chg'].astype(str))

    return pd.Series({
        'Top3_Holders': holders,
        'Top3_Shares_Held': shares,
        'Latest_Chg': latest_chg
    })

# Group by Ticker and apply the combine the three rows for each ticker into one
combined_df = top3_holders.groupby('Cusip').apply(combine_top3).reset_index()

# Function to check if the ticker should be flagged (Potential) or not (None)
def check_flagged(names, share_changes):
    firm1 = True if names.split(",")[0].strip() in flagged_firms and int(share_changes.split(",")[0].strip()) >= 0 else False
    firm2 = True if names.split(",")[1].strip() in flagged_firms and int(share_changes.split(",")[1].strip()) >= 0 else False
    firm3 = True if names.split(",")[2].strip() in flagged_firms and int(share_changes.split(",")[2].strip()) >= 0 else False
    return "Potential" if firm1 or firm2 or firm3 else "None"

# Apply the function to the DataFrame
combined_df['Activists'] = combined_df.apply(
    lambda row: check_flagged(row['Top3_Holders'], row['Latest_Chg']),
    axis=1
)

# Function that formats the changes in shares
def reformat(share_changes):
    changes = [int(change.strip()) for change in share_changes.split(",")]

    def format_share_size(number):
        if abs(number) >= 1_000_000:
            return f"{number / 1_000_000:.1f}mm"
        elif abs(number) >= 1_000:
            return f"{number / 1_000:.0f}K"
        elif number == 0:
            return "Flat"
        else:
            return str(number)
    
    formatted_changes = [format_share_size(change) for change in changes]
    return ", ".join(formatted_changes)

# Function that adds arrows to the share changes
def add_arrows(changes):
    changes_list = changes.split(', ')
    
    # Initialize a list to collect transformed numbers with arrows
    transformed_numbers = []
    
    # Process each number
    for change in changes_list:       
        if change.startswith("-"):
            transformed_numbers.append(f'( {change.strip("-")})')  # Add upward arrow before positive number
        elif change == "Flat":
            transformed_numbers.append(f'({change})')  # Add downward arrow before negative number
        else:
            transformed_numbers.append(f'( {change})')   # Keep zero as it is
    
    # Join the transformed numbers into a single string with commas
    result_string = ', '.join(transformed_numbers)
    return result_string

# Function that combines holder names and their respective changess
def combine_holders_changes(holders, changes):
    return ', '.join(f"{holders.split(', ')[i]} {changes.split(', ')[i].strip()}" for i in range(len(holders.split(', '))))

# Apply the formatting functions to the data frame       
combined_df['Latest_Chg'] = combined_df['Latest_Chg'].apply(lambda x: reformat(x)).apply(lambda x: add_arrows(x))
combined_df['Top 3 Holders'] = combined_df.apply(lambda row: combine_holders_changes(row['Top3_Holders'], row['Latest_Chg']), axis=1)

# Drop the total shares held column
combined_df.drop(columns=["Top3_Shares_Held", "Top3_Holders", "Latest_Chg"], inplace=True)

# Move the activists column to the second position
combined_df.insert(1, 'Activists', combined_df.pop('Activists'))

# Initialize the xlwings app
app = xw.App(visible=False)
wb = app.books.add()

# Initialize the first sheet by rendering the data frame
sheet = wb.sheets[0]
sheet['A1'].options(pd.DataFrame, index=False, header=True).value = combined_df

start_cell = sheet.range('C2')
end_cell = sheet.range('C' + str(sheet.cells.last_cell.row)).end('up')

# Iterate through each cell in column C to color the arrows
for cell in sheet.range(start_cell, end_cell):
    up_indices = [m.start() + 1 for m in re.finditer(r'[]', cell.value)]
    down_indices = [m.start() + 1 for m in re.finditer(r'[]', cell.value)]

    for index in up_indices:
        sheet.range(cell).api.GetCharacters(index, 1).Font.Color = rgb_to_int((0, 204, 102))  # Green
    for index in down_indices:
        sheet.range(cell).api.GetCharacters(index, 1).Font.Color = rgb_to_int((255, 0, 0))  # Red

start_cell = sheet.range('B2')
end_cell = sheet.range('B' + str(sheet.cells.last_cell.row)).end('up')  # Finds the last filled cell in column A

# Iterate through each cell in column B to color the "Potential" cells
for cell in sheet.range(start_cell, end_cell):
    if cell.value == "Potential":
        cell.font.color = rgb_to_int((156, 87, 0))
        cell.color = rgb_to_int((255, 235, 156))

# Center all the text in the used range
sheet.used_range.api.HorizontalAlignment = xw.constants.HAlign.xlHAlignCenter

# Auto-fit all columns in the used range of the sheet
sheet.autofit('columns')

#Save sheet to the file path and quit the app
file_path = f"S:\\Balyan\\ClosedEndFundProject\\Script\\{datetime.now().strftime("%Y-%m-%d %H;%M;%S")}.xlsx"
wb.save(file_path)
wb.close()
app.quit()